<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯• Models API</title>
    <style>
        body {
            font-family: 'Monaco', 'Courier New', monospace;
            background: #000;
            color: #0f0;
            padding: 20px;
            line-height: 1.6;
        }
        h1 { color: #0ff; }
        .model-card {
            background: #111;
            border: 1px solid #0f0;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .edition1 { border-color: #0f0; }
        .edition2 { border-color: #0ff; }
        .stats { color: #fff; }
        .success { color: #0f0; font-weight: bold; }
        .error { color: #f00; font-weight: bold; }
        pre { background: #222; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>ğŸ§ª Models API æµ‹è¯•é¡µé¢</h1>
    
    <div id="status">åŠ è½½ä¸­...</div>
    
    <h2>API å“åº”:</h2>
    <pre id="apiResponse"></pre>
    
    <h2>æ¨¡å‹åˆ—è¡¨:</h2>
    <div id="modelsList"></div>
    
    <h2>åˆ†ç»„ç»Ÿè®¡:</h2>
    <div id="groupStats"></div>

    <script>
        async function testModelsAPI() {
            const statusDiv = document.getElementById('status');
            const apiResponsePre = document.getElementById('apiResponse');
            const modelsListDiv = document.getElementById('modelsList');
            const groupStatsDiv = document.getElementById('groupStats');
            
            try {
                statusDiv.innerHTML = '<span class="success">âœ“ æ­£åœ¨è¯·æ±‚ /api/models...</span>';
                
                const response = await fetch('/api/models');
                const models = await response.json();
                
                // æ˜¾ç¤ºåŸå§‹JSON
                apiResponsePre.textContent = JSON.stringify(models, null, 2);
                
                // ç»Ÿè®¡
                const edition1 = models.filter(m => m.edition === '1');
                const edition2 = models.filter(m => m.edition === '2');
                
                statusDiv.innerHTML = `
                    <span class="success">âœ“ APIè¯·æ±‚æˆåŠŸï¼</span><br>
                    æ€»æ¨¡å‹æ•°: ${models.length}<br>
                    Edition 1: ${edition1.length} ä¸ª<br>
                    Edition 2: ${edition2.length} ä¸ª
                `;
                
                // æ˜¾ç¤ºæ¨¡å‹å¡ç‰‡
                let html = '';
                models.forEach(model => {
                    const editionClass = model.edition === '1' ? 'edition1' : 'edition2';
                    html += `
                        <div class="model-card ${editionClass}">
                            <h3>${model.name} (Edition ${model.edition})</h3>
                            <div class="stats">
                                <div>ID: ${model.id}</div>
                                <div>è´¦æˆ·ä»·å€¼: $${model.total_value.toLocaleString()}</div>
                                <div>æ”¶ç›Šç‡: ${model.profit_loss_percent.toFixed(2)}%</div>
                                <div>èƒœç‡: ${model.win_rate.toFixed(1)}%</div>
                                <div>äº¤æ˜“: ${model.trades} (${model.wins}W / ${model.losses}L)</div>
                            </div>
                        </div>
                    `;
                });
                modelsListDiv.innerHTML = html;
                
                // åˆ†ç»„ç»Ÿè®¡
                groupStatsDiv.innerHTML = `
                    <div class="model-card edition1">
                        <h3>Edition 1 (Basic)</h3>
                        ${edition1.map(m => `<div>â€¢ ${m.name}</div>`).join('')}
                    </div>
                    <div class="model-card edition2">
                        <h3>Edition 2 (With News ğŸ“°)</h3>
                        ${edition2.map(m => `<div>â€¢ ${m.name}</div>`).join('')}
                    </div>
                `;
                
                // æ£€æŸ¥é—®é¢˜
                if (models.length !== 4) {
                    statusDiv.innerHTML += '<br><span class="error">âš ï¸ è­¦å‘Š: æœŸæœ›4ä¸ªæ¨¡å‹ï¼Œä½†æ”¶åˆ° ' + models.length + ' ä¸ª</span>';
                }
                
            } catch (error) {
                statusDiv.innerHTML = `<span class="error">âœ— é”™è¯¯: ${error.message}</span>`;
                console.error('Error:', error);
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
        testModelsAPI();
        
        // æ¯5ç§’åˆ·æ–°ä¸€æ¬¡
        setInterval(testModelsAPI, 5000);
    </script>
</body>
</html>

