# Temperature A/B 测试实验

## 🎯 **实验设计**

### **实验目的**
通过真实交易数据对比不同temperature参数对AI交易表现的影响。

---

## 📊 **实验组设置**

### **Edition 1（对照组 - 保守策略）**
```python
Temperature: 0.3
模型: Qwen3-Max + DeepSeek V3.2
数据: 完整市场数据（30个数据点）
新闻: 无
策略: 纯技术分析 + 低温度（更保守）
```

**预期特点：**
- ✅ 更稳定，决策更一致
- ✅ 减少冲动交易
- ✅ 更保守的仓位选择
- ⚠️ 可能错过一些机会

---

### **Edition 2（实验组 - 灵活策略）**
```python
Temperature: 0.6
模型: Qwen3-Max + DeepSeek V3.2
数据: 完整市场数据（30个数据点）
新闻: 4个API源（CryptoPanic + CryptoCompare + CoinGecko + Messari）
策略: 技术分析 + 新闻 + 原温度（更灵活）
```

**预期特点：**
- ✅ 更灵活，可能抓住更多机会
- ✅ 新闻驱动的快速反应
- ⚠️ 可能有更多噪音交易
- ⚠️ 波动性可能更大

---

## 🔍 **对比维度**

### **1. 收益表现**
```
Edition 1 (0.3) vs Edition 2 (0.6)
- 总收益率
- 日收益率
- 周收益率
```

### **2. 风险指标**
```
- 最大回撤
- Sharpe Ratio
- 波动率
- 单笔最大亏损
```

### **3. 交易行为**
```
- 交易频率
- 持仓时长
- 杠杆使用（平均杠杆）
- 止损执行率
```

### **4. 决策质量**
```
- 胜率
- 盈亏比
- 信心度分布
- 错误交易频率
```

---

## 📈 **观察指标**

### **主要指标**（每天观察）

| 指标 | Edition 1 (0.3) | Edition 2 (0.6) | 优胜者 |
|------|----------------|----------------|--------|
| 总收益率 | ___ % | ___ % | ___ |
| 最大回撤 | ___ % | ___ % | ___ |
| 交易次数 | ___ | ___ | ___ |
| 胜率 | ___ % | ___ % | ___ |
| Sharpe Ratio | ___ | ___ | ___ |

### **次要指标**（每周分析）

| 指标 | Edition 1 (0.3) | Edition 2 (0.6) | 说明 |
|------|----------------|----------------|------|
| 平均持仓时长 | ___ 小时 | ___ 小时 | 更长 = 更保守 |
| 平均杠杆 | ___x | ___x | 更低 = 更保守 |
| 单笔平均盈利 | $__ | $__ | - |
| 单笔平均亏损 | $__ | $__ | 更小 = 风控好 |
| 手续费总计 | $__ | $__ | 更少 = 交易少 |

---

## 🧪 **实验假设**

### **假设1：Temperature 0.3更稳定**
```
H1: Edition 1的收益波动更小
验证方法: 计算收益率标准差
```

### **假设2：Temperature 0.3更保守**
```
H2: Edition 1的最大回撤更小
验证方法: 对比最大回撤百分比
```

### **假设3：Temperature 0.6交易更频繁**
```
H3: Edition 2的交易次数更多
验证方法: 统计交易笔数
```

### **假设4：新闻是否有用**
```
H4: Edition 2（有新闻）的决策质量是否更好？
验证方法: 对比胜率和盈亏比
注意: Edition 2同时有新闻和高temperature，需要拆解影响
```

---

## 📝 **实验记录**

### **第1天**（启动时间：____）

#### **Edition 1 (Temperature 0.3)**
- 初始资金: $100,000
- 首次交易时间: ____
- 首次决策: ____
- 观察: ____

#### **Edition 2 (Temperature 0.6 + News)**
- 初始资金: $100,000
- 首次交易时间: ____
- 首次决策: ____
- 观察: ____

---

### **第3天**

#### **阶段性数据**
| 指标 | Edition 1 | Edition 2 | 差异 |
|------|----------|----------|------|
| 总收益 | $__ | $__ | $__ |
| 收益率 | __% | __% | __% |
| 交易次数 | __ | __ | __ |
| 胜率 | __% | __% | __% |
| 最大回撤 | __% | __% | __% |

#### **观察笔记**
- Edition 1表现: ____
- Edition 2表现: ____
- 初步结论: ____

---

### **第7天**

#### **一周总结**
| 指标 | Edition 1 | Edition 2 | 优胜者 |
|------|----------|----------|--------|
| 周收益率 | __% | __% | ___ |
| 周回撤 | __% | __% | ___ |
| 总交易 | __ | __ | ___ |
| 周胜率 | __% | __% | ___ |
| Sharpe | __ | __ | ___ |

#### **关键发现**
1. ____
2. ____
3. ____

#### **调整建议**
- [ ] ____
- [ ] ____

---

## 🎯 **预期结果分析**

### **场景1：Edition 1 (0.3) 表现更好**
```
结论: 低温度更适合加密货币交易
原因可能:
- 减少噪音交易
- 更好的风险控制
- 避免过度反应市场波动

下一步:
- 两个版本都降到0.3
- 测试0.2和0.3的差异
```

### **场景2：Edition 2 (0.6) 表现更好**
```
结论: 可能是新闻的作用，不是温度
原因可能:
- 新闻提供了关键信号
- 0.6温度在有新闻时更合适
- 需要灵活性来应对新闻事件

下一步:
- 测试Edition 1 (0.6, 无新闻)
- 拆解新闻和温度的影响
```

### **场景3：表现相近**
```
结论: Temperature影响不大
原因可能:
- 0.3和0.6差异不够大
- 其他因素更重要（System Prompt、风险管理）

下一步:
- 测试更极端的对比（0.2 vs 0.8）
- 优先改进System Prompt和风险规则
```

---

## 🔬 **后续实验计划**

### **实验2：Temperature梯度测试**
```
如果场景1成立，测试:
- Edition 1: 0.2
- Edition 2: 0.3
- Edition 3: 0.4
找到最优温度
```

### **实验3：拆解新闻影响**
```
如果场景2成立，测试:
- Edition 1: 0.6, 无新闻
- Edition 2: 0.6, 有新闻
单独验证新闻价值
```

### **实验4：System Prompt优化**
```
无论哪个场景，都应该测试:
- 当前System Prompt
- 增强System Prompt（添加风险规则）
对比改进效果
```

---

## 📊 **实验配置代码**

### **Edition 1（ai_trader_v2.py）**
```python
def __init__(self, trader_id, name, strategy, model, leverage_engine, 
             kline_data, order_manager, temperature=0.3):
    # ...
    self.temperature = temperature  # 默认0.3
```

### **Edition 2（ai_trader_edition2.py）**
```python
def __init__(self, model_id, name, model, strategy, account, 
             leverage_engine, kline_data, order_manager):
    super().__init__(
        # ...
        temperature=0.6  # Edition 2保持0.6
    )
```

### **API调用**
```python
"temperature": self.temperature,  # 动态使用
```

---

## 🎓 **实验意义**

### **科学性**
- ✅ 对照实验（唯一变量）
- ✅ 真实数据验证
- ✅ 可重复性

### **实用性**
- ✅ 找到最优参数
- ✅ 理解温度影响
- ✅ 为未来优化提供数据

### **透明性**
- ✅ 所有数据公开
- ✅ 不隐藏失败结果
- ✅ 诚实记录

---

## 🚀 **实验状态**

- [x] 代码修改完成
- [ ] 部署到云端
- [ ] 开始实验
- [ ] 第1天数据收集
- [ ] 第3天阶段分析
- [ ] 第7天总结报告

---

## 📝 **备注**

### **实验限制**
1. Edition 2同时有新闻和高温度，无法完全隔离变量
2. 市场环境可能影响结果（牛市/熊市）
3. 1周时间可能不够（建议至少2周）

### **改进方向**
1. 后续可以做4组对比（有无新闻 × 高低温度）
2. 可以测试更多温度值（0.1, 0.2, 0.4, 0.8）
3. 可以结合System Prompt优化

---

**让我们开始实验吧！** 🧪



