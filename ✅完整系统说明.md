# 🎊 Alpha Arena 完整杠杆交易系统

## ✅ 系统已完全重构完成！

完整实现了 Alpha Arena 的核心功能，包括技术指标、杠杆交易、止损止盈等。

---

## 🌐 访问地址

**http://localhost:5001**

---

## ✅ 已实现的完整功能

### 1. 技术指标系统
**文件**: `technical_indicators.py`, `kline_data.py`

- ✅ **EMA** (指数移动平均): 20期和50期
- ✅ **MACD** (移动平均收敛发散): 12,26,9参数
- ✅ **RSI** (相对强弱指标): 7期和14期
- ✅ **ATR** (平均真实波幅): 3期和14期
- ✅ **K线数据存储**: 实时更新，保留500个数据点
- ✅ **指标序列**: 提供最近10个数据点供AI分析

**使用**: pandas_ta库 + 自定义计算

### 2. 杠杆交易引擎
**文件**: `leverage_engine.py`

- ✅ **杠杆倍数**: 支持5x-40x
- ✅ **清算价格计算**:
  - 多仓: 入场价 × (1 - 0.95/杠杆)
  - 空仓: 入场价 × (1 + 0.95/杠杆)
- ✅ **保证金管理**: 名义价值 / 杠杆倍数
- ✅ **未实现盈亏**: 实时追踪
- ✅ **已实现盈亏**: 平仓时计算
- ✅ **自动清算**: 价格触及清算价时自动平仓
- ✅ **手续费**: 0.1%每笔交易

### 3. 止损/止盈订单系统
**文件**: `order_manager.py`

- ✅ **止损单**: 自动监控和触发
- ✅ **止盈单**: 自动监控和触发  
- ✅ **条件订单**: 根据价格自动执行
- ✅ **订单管理**: 创建、监控、执行

### 4. AI决策系统
**文件**: `ai_trader_v2.py`

- ✅ **详细Prompt**: 包含所有技术指标
- ✅ **杠杆决策**: AI选择杠杆倍数
- ✅ **风险管理**: 自动计算止损止盈
- ✅ **对话记录**: 保存AI分析

### 5. 统计系统
- ✅ **胜率**: wins / (wins + losses)
- ✅ **最大赢利**: 追踪最大单笔盈利
- ✅ **最大亏损**: 追踪最大单笔亏损
- ✅ **Sharpe比率**: 基于收益率计算
- ✅ **累计手续费**: 所有交易的手续费总和
- ✅ **已实现盈亏**: 所有已平仓的盈亏总和

---

## 🤖 2个AI交易员

### QWEN3 MAX
- **模型**: qwen/qwen-2.5-72b-instruct
- **策略**: 激进型
- **特点**: 追求高收益，使用较高杠杆
- **起始资金**: $10,000

### DEEPSEEK CHAT V3.1
- **模型**: deepseek/deepseek-chat
- **策略**: 平衡型
- **特点**: 平衡风险与收益
- **起始资金**: $10,000

---

## 💰 真实数据源

### Finnhub API
- ✅ 实时价格（BTC, ETH, SOL, BNB, DOGE, XRP）
- ✅ 真实涨跌幅（dp字段）
- ✅ 连续更新

### 技术指标
- ✅ 基于真实价格计算
- ✅ 使用pandas_ta专业库
- ✅ 实时更新

---

## 📊 界面功能

### LIVE页面
- 大图表显示AI的账户价值曲线
- 技术指标实时计算
- 2个AI卡片显示状态
- 右侧详情面板:
  - 完成交易（杠杆交易记录）
  - 模型对话（AI分析）
  - 持仓（杠杆持仓详情）
  - README.TXT

### LEADERBOARD页面
- 完整统计表格
- 11列数据（与Alpha Arena一致）
- 包含费用、胜率、Sharpe等

### MODELS页面
- AI模型详细说明
- 策略介绍

---

## 🔧 技术细节

### 杠杆交易流程
```
1. AI分析技术指标
2. 决定开仓（多/空）
3. 选择杠杆倍数（5x-40x）
4. 计算保证金需求
5. 计算清算价格
6. 设置止损止盈
7. 执行交易
8. 创建止损止盈订单
9. 持续监控
10. 自动触发/清算
```

### 清算机制
```
多仓清算: 当前价 ≤ 清算价
空仓清算: 当前价 ≥ 清算价

清算时: 自动平仓，损失保证金
```

### 止损止盈
```
每个持仓都有:
- profit_target: 止盈价格
- stop_loss: 止损价格
- invalidation_condition: 失效条件

系统每个周期检查是否触发
```

---

## 🎯 使用指南

### 立即开始
1. 访问 **http://localhost:5001**
2. 系统已自动启动竞赛
3. 等待2-3分钟观察AI开始交易

### 查看活动
```bash
# 实时日志
tail -f /tmp/alpha_v2.log

# 查看交易
curl http://127.0.0.1:5001/api/trades

# 查看排行榜
curl http://127.0.0.1:5001/api/leaderboard_full
```

---

## ⚠️ 重要说明

### 虚拟交易
- ❌ 不使用真实资金
- ❌ 不进行真实交易
- ❌ 不连接真实交易所

### 真实数据
- ✅ 真实AI模型（OpenRouter）
- ✅ 真实市场价格（Finnhub）
- ✅ 真实技术指标计算
- ✅ 专业的杠杆交易逻辑

---

## 📁 系统文件

### 核心模块（新）
- `technical_indicators.py` - 技术指标计算
- `kline_data.py` - K线数据管理
- `leverage_engine.py` - 杠杆交易引擎
- `order_manager.py` - 订单管理系统
- `ai_trader_v2.py` - AI交易代理V2
- `app_v2.py` - 主应用V2

### 配置和数据
- `config.py` - AI模型配置
- `market_data.py` - 市场数据获取

### 前端
- `templates/index.html` - 界面
- `static/css/style.css` - 深色主题
- `static/js/app.js` - 交互逻辑

---

## 🎊 系统亮点

### 完整性
✅ 所有Alpha Arena核心功能已实现
✅ 技术指标系统完整
✅ 杠杆交易逻辑完整
✅ 订单管理系统完整

### 真实性
✅ 真实的AI模型（2个顶级模型）
✅ 真实的市场数据
✅ 真实的技术指标计算
✅ 真实的涨跌幅数据

### 专业性
✅ 清算机制
✅ 止损止盈
✅ 保证金管理
✅ 风险控制

---

## 🚀 立即使用

**访问**: http://localhost:5001

**系统状态**:
- ✅ 运行中
- ✅ 2个AI已启动
- ✅ 杠杆交易系统激活
- ✅ 技术指标实时计算

---

**享受完整的Alpha Arena杠杆交易体验！** 🎊



